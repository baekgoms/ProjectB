<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="adminMain">

<!-- ==============================새로운 회원=========================== -->
	<select id="getCountPetitionerToday" resultType="int" parameterType="String">
		select count(*) from petitioner where TO_CHAR(reg, 'YYYYMMDD') = #{today}
	</select>
	
	<select id="getCountPetitionerTillYesterday" resultType="int" parameterType="String">
		select count(*) from petitioner where TO_CHAR(reg, 'YYYYMMDD') != #{today}
	</select>
	
<!-- ==============================새로운 신고=========================== -->	
	
<!-- ==============================새로운 청원=========================== -->	
	<select id="getCountPetitionToday" resultType="int" parameterType="String">
		select count(*) from petition where TO_CHAR(startDate, 'YYYYMMDD') = #{today}
	</select>
	
	<select id="getCountPetitionTillYesterday" resultType="int" parameterType="String">
		select count(*) from petition where TO_CHAR(startDate, 'YYYYMMDD') != #{today}
	</select>
	
<!-- ==============================새로운 토론=========================== -->	
	<select id="getCountDiscussionToday" resultType="int" parameterType="String">
		select count(*) from Discussion where TO_CHAR(reg, 'YYYYMMDD') = #{today}
	</select>
	
	<select id="getCountDiscussionTillYesterday" resultType="int" parameterType="String">
		select count(*) from Discussion where TO_CHAR(reg, 'YYYYMMDD') != #{today}
	</select>	
	
	
<!-- ==============================인기 청원=========================== -->
	<select id="getTopPetition" resultType="petitionDTO" parameterType="String">
		select * from petition where petition = (SELECT max(petition) FROM petition 
		where petitionState = 2 and startDate >= ADD_MONTHS(sysdate, -1))
	</select>

	<select id="getRestDay" resultType="int" parameterType="String">
		SELECT endDate - SYSDATE FROM petition
		where petition = (SELECT max(petition) FROM petition 
		where petitionState = 2 and startDate >= ADD_MONTHS(sysdate, -1))
	</select>
	
<!-- ==============================인기 토론=========================== -->
	<select id="getTopDiscussion" resultType="discussionDTO">
		SELECT * FROM DISCUSSION 
		WHERE (OPPOSITION+AGREEMENT) = (SELECT MAX(OPPOSITION+AGREEMENT) FROM DISCUSSION 
		WHERE open = 0 and reg >= ADD_MONTHS(sysdate, -1))	
	
	</select>

 
</mapper>

